# 1. 前情回顾

## 1.1. 使用二进制安装部署k8s的要点

- 基础设施环境准备好
  - centos7.6系统（内核在3.8.x以上）
  - 关闭SELinux，关闭firewalld服务
  - 时间同步（chronyd）
  - 调整Base源，Epel源
  - 内核优化（文件描述符大小，内核转发，等等...）
- 安装部署bind9内网DNS系统
- 安装部署docker的私有仓库-harbor
- 准备证书签发环境-cfssl
- 安装部署主控结点服务（4个）
  - Etcd
  - Apiserver
  - Controller-manager
  - Scheduler
- 安装部署运算节点服务（2个）
  - Kubelet
  - Kube-proxy

## 1.2. 关于cfssl工具

- cfssl： 证书签发的主要工具
- cfssl-json: 将cfssl生成的证书（json格式）变为文件承载式证书
- cfssl-certinfo：验证证书的信息

```bash
cfssl-certinfo -cert apiserver.pem
cfssl-certinfo -domain www.baidu.com
md5sum kubelet.kubeconfig

# 多个证书揉一起的情况
[root@hdss7-21 conf]# echo "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR3akNDQXFxZ0F3SUJBZ0lVZDV4Q045L2RvMzJ4SUFySXErbmZzWVFuMXc0d0RRWUpLb1pJaHZjTkFRRUwKQlFBd1lERUxNQWtHQTFVRUJoTUNRMDR4RURBT0JnTlZCQWdUQjJKbGFXcHBibWN4RURBT0JnTlZCQWNUQjJKbAphV3BwYm1jeEN6QUpCZ05WQkFvVEFtOWtNUXd3Q2dZRFZRUUxFd052Y0hNeEVqQVFCZ05WQkFNVENVOXNaR0p2CmVVVmtkVEFlRncweU1ERXhNREl4TVRFd01EQmFGdzAwTURFd01qZ3hNVEV3TURCYU1GOHhDekFKQmdOVkJBWVQKQWtOT01SQXdEZ1lEVlFRSUV3ZGlaV2xxYVc1bk1SQXdEZ1lEVlFRSEV3ZGlaV2xxYVc1bk1Rc3dDUVlEVlFRSwpFd0p2WkRFTU1Bb0dBMVVFQ3hNRGIzQnpNUkV3RHdZRFZRUURFd2hyT0hNdGJtOWtaVENDQVNJd0RRWUpLb1pJCmh2Y05BUUVCQlFBRGdnRVBBRENDQVFvQ2dnRUJBTk1nekRFTEIxQUNuOEphcjdNMDZqeXNUM0xheG90ZmhnbDcKSmN5NnJYZ0laLy9kZGdab0JydkN0ZFR5a3RpQ0hsRzNhL3ZCUjNYVEwyWTVTVEdaaEowQi9EditranhPWTZqbQo4bmxIeXJRNnpBSUc2c2psWUp3Z2tGWC9XL2pUOTVZeWJKMHNMMGV2QmFDQ01wRytLNGNnL2tKU2VaL2tYbUxkClluKzA5ek1rWHFQbFdDRWV2emxrQ05tVjRlaGU1TmRoTElMeXFTcHlhQzV5V2wyNHBNWnc0aTBWNldxcVVXd0gKdVI4cUNYalpzVDBMWEZQK0RmVEVFcEgyTm13eUgvNXFoQ2VzMXNIV213SzEybGxFbnJsdllRSDdXUGRzaThiZwphdGRsYjVVSDRBdjVjaGxId21RUFU1Q0YzYzB3aG0xWnFaMzBPTjdqeG43YS9hc0V0WjBDQXdFQUFhTjFNSE13CkRnWURWUjBQQVFIL0JBUURBZ1dnTUJNR0ExVWRKUVFNTUFvR0NDc0dBUVVGQndNQ01Bd0dBMVVkRXdFQi93UUMKTUFBd0hRWURWUjBPQkJZRUZEU0haSFYvZHpPOXNQSWxOZWlHYVBnemF0M0RNQjhHQTFVZEl3UVlNQmFBRk9zMwptdDNxbDUrZ3pVM2lxVnVvU1cwQW9lMjZNQTBHQ1NxR1NJYjNEUUVCQ3dVQUE0SUJBUUErVzcwTFV5SHR2YTNvCkQwNUFOSTFmZVRDbHVBQmhMVW1wQzFHaUlCbjl6UnFqVVlOb2g2a1pwV3NzalArNE5vNlJWWFhxc0R5NnpiZUYKa1M1Rm4xVmZWREJqZVJhdU5nNTE3clpuU3lKU25TTWRsd3Y4dEdHTHBrdE1neU1GeEw1STJ0Z05JdmFMSXFoZApsZ240NitVOWdWd1FCMGhyWXNrNGlmY1lxN0JnajNZQ2dVMWduUnNoczNSWThOZW96eStuUEpaOFZkNjRJdEJOCjV3UEQ4OXNHRzEwTkNWUnc5eU56ajQwM1QvU1VqcldyeXBHeHhYZnBiMkZTK2Y3OTVRajByZE5LVjZDV0M2cXAKTk1lSUs1cnFwOGlTeU5MeGdVOTB2RFdEWFZwNlEyTkhGVkZQZ2loL2dhdm9LS0JsL3IvT3JaeTJJUGcweUdOQgpKR2xnS3UxYQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==" |base64 -d > 123.pem

cfssl-certinfo -cert 123.pem
```



## 1.3. 关于kubeconfig文件

- 这是一个k8s用户的配置文件
- 它里面含有证书信息
- 证书过期或者更换，需要同步替换该文件

## 1.4. 学习路线

- kubectl 命令行工具使用详解
- kubernetes的CNI网络插件-flannel
- kubernetes的服务发现插件-coredns
- kubernetes的服务暴露插件-traefik
- kubernetes的GUI管理工具-dashboard
- kubernetes的dashboard监控小插件-heapster
- kubernetes集群的生产运维经验
- 总结和展望